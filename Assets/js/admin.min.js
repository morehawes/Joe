function waymark_setup_parameter_tooltips(){jQuery("a.waymark-tooltip").on({mouseenter:function(a){var e=jQuery(this).data("title");jQuery('<p id="waymark-tooltip-active"></p>').text(e).appendTo("body").fadeIn("slow")},mouseleave:function(a){jQuery("#waymark-tooltip-active").remove()},mousemove:function(a){if(waymark_is_touch_device())var e=a.pageX-250;else e=a.pageX-220;var t=a.pageY+5;jQuery("#waymark-tooltip-active").css({top:t,left:e})}})}function waymark_is_touch_device(){var a=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)||function(a){return window.matchMedia(a).matches}(["(",a.join("touch-enabled),("),"heartz",")"].join(""))}function waymark_setup_accordions(){var a=jQuery(".waymark-accordion-container");a.length&&(a.addClass("waymark-self-clear"),a.each((function(){var a=0;jQuery(".waymark-accordion-group",jQuery(this)).each((function(){var e=jQuery(this);e.addClass("waymark-self-clear"),e.data("waymark-index",a);var t=jQuery(".waymark-accordion-group-content",e);0==a?(e.addClass("waymark-first waymark-active"),t.show().addClass(a)):t.hide().addClass(a),jQuery("legend",jQuery(this)).each((function(){var e=jQuery(this).html();if(-1==e.indexOf("[+]")&&-1==e.indexOf("[-]")){var t=0==a?"[-]":"[+]";jQuery(this).html(e+" <span>"+t+"</span>")}jQuery(this).click((function(){var a=jQuery(this).parents(".waymark-accordion-group").data("waymark-index");jQuery(".waymark-accordion-group",jQuery(this).parents(".waymark-accordion-container")).each((function(){if(jQuery(this).data("waymark-index")==a){var e=jQuery("legend",jQuery(this));jQuery(this).hasClass("waymark-active")?(e.html(e.html().replace("[-]","[+]")),jQuery(this).removeClass("waymark-active"),jQuery(".waymark-accordion-group-content",jQuery(this)).slideUp()):(e.html(e.html().replace("[+]","[-]")),jQuery(this).addClass("waymark-active"),jQuery(".waymark-accordion-group-content",jQuery(this)).slideDown())}else{jQuery(this).removeClass("waymark-active"),(e=jQuery("legend",jQuery(this))).html(e.html().replace("[-]","[+]")),jQuery(".waymark-accordion-group-content",jQuery(this)).slideUp()}}))}))})),a++}))})))}function joe_setup_colour_pickers(){jQuery(".waymark-colour-picker .waymark-input").wpColorPicker()}function joe_setup_repeatable_settings(){jQuery(".waymark-settings-tab .waymark-repeatable").each((function(){var a=jQuery(this);jQuery(".form-table",a).each((function(){var e=jQuery(this),t=[];for(e.remove(),jQuery(".waymark-input",e).each((function(){var a=jQuery(this);if(a.addClass("waymark-"+a.data("id")),"SELECT"!=a.get(0).nodeName)var e=a.val();else e=a.data("multi-value");for(i in"string"!=typeof e&&(e=e.toString()),e=e.split(waymark_admin_js.multi_value_seperator))"object"!=typeof t[i]&&(t[i]={}),t[i][a.data("id")]=e[i]})),i=0;i<t.length;i++){var r=e.clone();for(j in t[i]){var n=t[i][j],o=jQuery(".waymark-input-"+j,r);o.attr("name",o.attr("name")+"["+i+"]"),"SELECT"!=o.get(0).nodeName||jQuery("option[value='"+t[i][j]+"']",o).length||(n=jQuery("option",o).first().val()),o.attr("value",n).val(n),o.parents(".waymark-control-group").hasClass("waymark-uneditable")&&o.attr("readonly","readonly")}var s=jQuery("<div />").text("x").attr("title",waymark_admin_js.lang.repeatable_delete_title).addClass("waymark-delete").on("click",(function(a){return a.preventDefault(),jQuery(this).parents(".form-table").remove(),!1}));r.append(s),a.append(r),a.attr("data-count",i),waymark_setup_parameter_tooltips()}var u=jQuery("<button />").html('<i class="ion ion-plus"></i>').addClass("button waymark-add").on("click",(function(a){a.preventDefault();var t=jQuery(this).parents(".waymark-repeatable"),r=parseInt(t.attr("data-count"))+1;t.attr("data-count",r);var n=e.clone();return jQuery(".waymark-input",n).each((function(){var a=jQuery(this),e=a.attr("name")+"["+r+"]";switch(a.attr("name",e),a.attr("placeholder",""),"SELECT"!=a.get(0).nodeName&&a.val(""),a.data("id")){case"line_colour":case"shape_colour":case"icon_colour":case"marker_colour":a.wpColorPicker();break;case"meta_options":a.parents("tr").hide()}})),jQuery(this).before(n),waymark_setup_parameter_tooltips(),!1}));a.append(u),a.sortable()}))}))}function joe_setup_dropdowns(){jQuery(".waymark-parameters-container").each((function(){var a=jQuery(this);jQuery("select",a).each((function(){var e="waymark-dropdown-"+jQuery(this).data("id")+"-";e+=jQuery(this).val(),a.addClass(e),jQuery(this).on("change",(function(){var e="waymark-dropdown-"+jQuery(this).data("id")+"-";jQuery("option",jQuery(this)).each((function(){a.removeClass(e+jQuery(this).attr("value"))})),e+=jQuery(this).val(),a.addClass(e)}))}))}))}function joe_setup_settings_nav(){var a=jQuery("body.wp-admin.waymark_page_waymark-settings #waymark-settings-nav");if(!a)return!1;var e=jQuery("#waymark-admin-container"),t=jQuery("form",e),r=(jQuery(".waymark-settings-tab",e),a.data("init_tab_key")),n=jQuery("select",a);n.hover((function(){jQuery(this).attr("size",jQuery("option",jQuery(this)).length)}),(function(){jQuery(this).removeAttr("size")})),n.change((function(){n.removeAttr("size");var a=jQuery(this).val();e.attr("class","");var i=jQuery('input[name="_wp_http_referer"]',t),o=document.location.toString();o=o.indexOf("content=")>0?o.replace("content="+r,"content="+a):o+"&content="+a,i.val(o);jQuery("."+a).first();jQuery(".waymark-settings-tab").each((function(){var t=jQuery(this);t.hide(),a.indexOf("settings-tab")&&t.hasClass(a)&&(t.show(),e.addClass("waymark-active-"+a)),jQuery(".waymark-settings-section",t).each((function(){var r=jQuery(this);a.indexOf("settings-tab")>0?r.show():a.indexOf("settings-section")>0&&(r.hide(),r.hasClass(a)&&(t.show(),r.show(),e.addClass("waymark-active-"+a)))}))}))})),n.trigger("change")}function joe_setup_repeatable_parameters(){jQuery(".waymark-repeatable-container").each((function(){var a=jQuery(this),e=a.data("count"),t=jQuery(".waymark-repeatable-template",a);t.removeClass("waymark-repeatable-template"),t.remove(),jQuery(".waymark-parameters-container",a).each((function(){var a=jQuery(this),e=jQuery("<button />").html('<i class="ion ion-android-delete"></i>').addClass("button waymark-delete").on("click",(function(e){e.preventDefault(),a.remove()}));a.append(e)}));var r=jQuery(".waymark-repeatable-add",a).first();r.on("click",(function(n){n.preventDefault();var i=t.clone();return jQuery(".waymark-input",i).each((function(){var a=jQuery(this);a.attr("name",a.attr("name").replace("__count__",e))})),jQuery(".waymark-control-label",i).each((function(){var a=jQuery(this);a.attr("for",a.attr("for").replace("__count__",e))})),r.before(i),i=waymark_handle_repeatable_clone(i),joe_setup_dropdowns(),a.data("count",++e),!1}))}))}function waymark_admin_message(a=null,e="info",t="#wpbody-content"){if(a){var r="";void 0!==waymark_admin_js.lang[e+"_message_prefix"]&&(r=waymark_admin_js.lang[e+"_message_prefix"]),r&&(r="<b>["+r+"]</b> ");var n=r+a,i=jQuery(t).first();if(i.length){jQuery(".waymark-notice",i).each((function(){jQuery(this).remove()}));var o=jQuery("<div />").attr({class:"waymark-notice notice notice-"+e}),s=jQuery("<p />").html(n);o.append(s),i.prepend(o)}else alert(n)}}jQuery(document).ready((function(){waymark_setup_parameter_tooltips(),waymark_setup_accordions()})),jQuery(document).ready((function(){joe_setup_colour_pickers(),joe_setup_settings_nav(),joe_setup_repeatable_settings(),joe_setup_repeatable_parameters(),joe_setup_dropdowns()}));