function joe_setup_parameter_tooltips(){jQuery("a.joe-tooltip").on({mouseenter:function(e){var t=jQuery(this).data("title");jQuery('<p id="joe-tooltip-active"></p>').text(t).appendTo("body").fadeIn("slow")},mouseleave:function(e){jQuery("#joe-tooltip-active").remove()},mousemove:function(e){if(waymark_is_touch_device())var t=e.pageX-250;else t=e.pageX-220;var a=e.pageY+5;jQuery("#joe-tooltip-active").css({top:a,left:t})}})}function waymark_is_touch_device(){var e=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)||function(e){return window.matchMedia(e).matches}(["(",e.join("touch-enabled),("),"heartz",")"].join(""))}function waymark_setup_accordions(){var e=jQuery(".waymark-accordion-container");e.length&&(e.addClass("waymark-self-clear"),e.each((function(){var e=0;jQuery(".waymark-accordion-group",jQuery(this)).each((function(){var t=jQuery(this);t.addClass("waymark-self-clear"),t.data("waymark-index",e);var a=jQuery(".waymark-accordion-group-content",t);0==e?(t.addClass("waymark-first waymark-active"),a.show().addClass(e)):a.hide().addClass(e),jQuery("legend",jQuery(this)).each((function(){var t=jQuery(this).html();if(-1==t.indexOf("[+]")&&-1==t.indexOf("[-]")){var a=0==e?"[-]":"[+]";jQuery(this).html(t+" <span>"+a+"</span>")}jQuery(this).click((function(){var e=jQuery(this).parents(".waymark-accordion-group").data("waymark-index");jQuery(".waymark-accordion-group",jQuery(this).parents(".waymark-accordion-container")).each((function(){if(jQuery(this).data("waymark-index")==e){var t=jQuery("legend",jQuery(this));jQuery(this).hasClass("waymark-active")?(t.html(t.html().replace("[-]","[+]")),jQuery(this).removeClass("waymark-active"),jQuery(".waymark-accordion-group-content",jQuery(this)).slideUp()):(t.html(t.html().replace("[+]","[-]")),jQuery(this).addClass("waymark-active"),jQuery(".waymark-accordion-group-content",jQuery(this)).slideDown())}else{jQuery(this).removeClass("waymark-active"),(t=jQuery("legend",jQuery(this))).html(t.html().replace("[-]","[+]")),jQuery(".waymark-accordion-group-content",jQuery(this)).slideUp()}}))}))})),e++}))})))}function joe_setup_repeatable_settings(){jQuery(".joe-settings-tab .joe-repeatable").each((function(){var e=jQuery(this);jQuery(".form-table",e).each((function(){var t=jQuery(this),a=[];for(t.remove(),jQuery(".joe-input",t).each((function(){var e=jQuery(this);if(e.addClass("joe-"+e.data("id")),"SELECT"!=e.get(0).nodeName)var t=e.val();else t=e.data("multi-value");for(i in"string"!=typeof t&&(t=t.toString()),t=t.split(joe_admin_js.multi_value_seperator))"object"!=typeof a[i]&&(a[i]={}),a[i][e.data("id")]=t[i]})),i=0;i<a.length;i++){var r=t.clone();for(j in a[i]){var o=a[i][j],n=jQuery(".joe-input-"+j,r);n.attr("name",n.attr("name")+"["+i+"]"),"SELECT"!=n.get(0).nodeName||jQuery("option[value='"+a[i][j]+"']",n).length||(o=jQuery("option",n).first().val()),n.attr("value",o).val(o),n.parents(".joe-control-group").hasClass("joe-uneditable")&&n.attr("readonly","readonly")}var s=jQuery("<div />").text("x").attr("title",joe_admin_js.lang.repeatable_delete_title).addClass("joe-delete").on("click",(function(e){return e.preventDefault(),jQuery(this).parents(".form-table").remove(),!1}));r.append(s),e.append(r),e.attr("data-count",i),joe_setup_parameter_tooltips()}var u=jQuery("<button />").html('<i class="ion ion-plus"></i>').addClass("button joe-add").on("click",(function(e){e.preventDefault();var a=jQuery(this).parents(".joe-repeatable"),r=parseInt(a.attr("data-count"))+1;a.attr("data-count",r);var o=t.clone();return jQuery(".joe-input",o).each((function(){var e=jQuery(this),t=e.attr("name")+"["+r+"]";switch(e.attr("name",t),e.attr("placeholder",""),"SELECT"!=e.get(0).nodeName&&e.val(""),e.data("id")){case"line_colour":case"shape_colour":case"icon_colour":case"marker_colour":e.wpColorPicker();break;case"meta_options":e.parents("tr").hide()}})),jQuery(this).before(o),joe_setup_parameter_tooltips(),!1}));e.append(u),e.sortable()}))}))}function joe_setup_dropdowns(){jQuery(".joe-parameters-container").each((function(){var e=jQuery(this);jQuery("select",e).each((function(){var t="joe-dropdown-"+jQuery(this).data("id")+"-";t+=jQuery(this).val(),e.addClass(t),jQuery(this).on("change",(function(){var t="joe-dropdown-"+jQuery(this).data("id")+"-";jQuery("option",jQuery(this)).each((function(){e.removeClass(t+jQuery(this).attr("value"))})),t+=jQuery(this).val(),e.addClass(t)}))}))}))}function joe_setup_settings_nav(){var e=jQuery("body.wp-admin #joe-settings-nav");if(!e)return!1;var t=jQuery("#joe-admin-container"),a=jQuery("form",t),r=(jQuery(".joe-settings-tab",t),e.data("init_tab_key")),o=jQuery("select",e);o.hover((function(){jQuery(this).attr("size",jQuery("option",jQuery(this)).length)}),(function(){jQuery(this).removeAttr("size")})),o.change((function(){o.removeAttr("size");var e=jQuery(this).val();t.attr("class","");var n=jQuery('input[name="_wp_http_referer"]',a),i=document.location.toString();i=i.indexOf("content=")>0?i.replace("content="+r,"content="+e):i+"&content="+e,n.val(i);jQuery("."+e).first();jQuery(".joe-settings-tab").each((function(){var a=jQuery(this);a.hide(),e.indexOf("settings-tab")&&a.hasClass(e)&&(a.show(),t.addClass("joe-active-"+e)),jQuery(".joe-settings-section",a).each((function(){var r=jQuery(this);e.indexOf("settings-tab")>0?r.show():e.indexOf("settings-section")>0&&(r.hide(),r.hasClass(e)&&(a.show(),r.show(),t.addClass("joe-active-"+e)))}))}))})),o.trigger("change")}function joe_setup_repeatable_parameters(){jQuery(".joe-repeatable-container").each((function(){var e=jQuery(this),t=e.data("count"),a=jQuery(".joe-repeatable-template",e);a.removeClass("joe-repeatable-template"),a.remove(),jQuery(".joe-parameters-container",e).each((function(){var e=jQuery(this),t=jQuery("<button />").html('<i class="ion ion-android-delete"></i>').addClass("button joe-delete").on("click",(function(t){t.preventDefault(),e.remove()}));e.append(t)}));var r=jQuery(".joe-repeatable-add",e).first();r.on("click",(function(o){o.preventDefault();var n=a.clone();return jQuery(".joe-input",n).each((function(){var e=jQuery(this);e.attr("name",e.attr("name").replace("__count__",t))})),jQuery(".waymark-control-label",n).each((function(){var e=jQuery(this);e.attr("for",e.attr("for").replace("__count__",t))})),r.before(n),console.log(typeof joe_handle_repeatable_clone),n=waymark_handle_repeatable_clone(n),joe_setup_dropdowns(),e.data("count",++t),!1}))}))}function waymark_admin_message(e=null,t="info",a="#wpbody-content"){if(e){var r="";void 0!==joe_admin_js.lang[t+"_message_prefix"]&&(r=joe_admin_js.lang[t+"_message_prefix"]),r&&(r="<b>["+r+"]</b> ");var o=r+e,n=jQuery(a).first();if(n.length){jQuery(".waymark-notice",n).each((function(){jQuery(this).remove()}));var i=jQuery("<div />").attr({class:"waymark-notice notice notice-"+t}),s=jQuery("<p />").html(o);i.append(s),n.prepend(i)}else alert(o)}}jQuery(document).ready((function(){joe_setup_parameter_tooltips(),waymark_setup_accordions()})),jQuery(document).ready((function(){joe_setup_settings_nav(),joe_setup_repeatable_settings(),joe_setup_repeatable_parameters(),joe_setup_dropdowns()}));