function joe_setup_parameter_tooltips(){jQuery("a.joe-tooltip").on({mouseenter:function(e){var a=jQuery(this).data("title");jQuery('<p id="joe-tooltip-active"></p>').text(a).appendTo("body").fadeIn("slow")},mouseleave:function(e){jQuery("#joe-tooltip-active").remove()},mousemove:function(e){if(waymark_is_touch_device())var a=e.pageX-250;else a=e.pageX-220;var t=e.pageY+5;jQuery("#joe-tooltip-active").css({top:t,left:a})}})}function waymark_is_touch_device(){var e=" -webkit- -moz- -o- -ms- ".split(" ");return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)||function(e){return window.matchMedia(e).matches}(["(",e.join("touch-enabled),("),"heartz",")"].join(""))}function waymark_setup_accordions(){var e=jQuery(".waymark-accordion-container");e.length&&(e.addClass("waymark-self-clear"),e.each((function(){var e=0;jQuery(".waymark-accordion-group",jQuery(this)).each((function(){var a=jQuery(this);a.addClass("waymark-self-clear"),a.data("waymark-index",e);var t=jQuery(".waymark-accordion-group-content",a);0==e?(a.addClass("waymark-first waymark-active"),t.show().addClass(e)):t.hide().addClass(e),jQuery("legend",jQuery(this)).each((function(){var a=jQuery(this).html();if(-1==a.indexOf("[+]")&&-1==a.indexOf("[-]")){var t=0==e?"[-]":"[+]";jQuery(this).html(a+" <span>"+t+"</span>")}jQuery(this).click((function(){var e=jQuery(this).parents(".waymark-accordion-group").data("waymark-index");jQuery(".waymark-accordion-group",jQuery(this).parents(".waymark-accordion-container")).each((function(){if(jQuery(this).data("waymark-index")==e){var a=jQuery("legend",jQuery(this));jQuery(this).hasClass("waymark-active")?(a.html(a.html().replace("[-]","[+]")),jQuery(this).removeClass("waymark-active"),jQuery(".waymark-accordion-group-content",jQuery(this)).slideUp()):(a.html(a.html().replace("[+]","[-]")),jQuery(this).addClass("waymark-active"),jQuery(".waymark-accordion-group-content",jQuery(this)).slideDown())}else{jQuery(this).removeClass("waymark-active"),(a=jQuery("legend",jQuery(this))).html(a.html().replace("[-]","[+]")),jQuery(".waymark-accordion-group-content",jQuery(this)).slideUp()}}))}))})),e++}))})))}function joe_setup_repeatable_settings(){jQuery(".joe-settings-tab .joe-repeatable").each((function(){var e=jQuery(this);jQuery(".form-table",e).each((function(){var a=jQuery(this),t=[];for(a.remove(),jQuery(".joe-input",a).each((function(){var e=jQuery(this);if(e.addClass("joe-"+e.data("id")),"SELECT"!=e.get(0).nodeName)var a=e.val();else a=e.data("multi-value");for(i in"string"!=typeof a&&(a=a.toString()),a=a.split(waymark_admin_js.multi_value_seperator))"object"!=typeof t[i]&&(t[i]={}),t[i][e.data("id")]=a[i]})),i=0;i<t.length;i++){var r=a.clone();for(j in t[i]){var o=t[i][j],n=jQuery(".joe-input-"+j,r);n.attr("name",n.attr("name")+"["+i+"]"),"SELECT"!=n.get(0).nodeName||jQuery("option[value='"+t[i][j]+"']",n).length||(o=jQuery("option",n).first().val()),n.attr("value",o).val(o),n.parents(".joe-control-group").hasClass("joe-uneditable")&&n.attr("readonly","readonly")}var s=jQuery("<div />").text("x").attr("title",waymark_admin_js.lang.repeatable_delete_title).addClass("joe-delete").on("click",(function(e){return e.preventDefault(),jQuery(this).parents(".form-table").remove(),!1}));r.append(s),e.append(r),e.attr("data-count",i),joe_setup_parameter_tooltips()}var u=jQuery("<button />").html('<i class="ion ion-plus"></i>').addClass("button joe-add").on("click",(function(e){e.preventDefault();var t=jQuery(this).parents(".joe-repeatable"),r=parseInt(t.attr("data-count"))+1;t.attr("data-count",r);var o=a.clone();return jQuery(".joe-input",o).each((function(){var e=jQuery(this),a=e.attr("name")+"["+r+"]";switch(e.attr("name",a),e.attr("placeholder",""),"SELECT"!=e.get(0).nodeName&&e.val(""),e.data("id")){case"line_colour":case"shape_colour":case"icon_colour":case"marker_colour":e.wpColorPicker();break;case"meta_options":e.parents("tr").hide()}})),jQuery(this).before(o),joe_setup_parameter_tooltips(),!1}));e.append(u),e.sortable()}))}))}function joe_setup_dropdowns(){jQuery(".joe-parameters-container").each((function(){var e=jQuery(this);jQuery("select",e).each((function(){var a="joe-dropdown-"+jQuery(this).data("id")+"-";a+=jQuery(this).val(),e.addClass(a),jQuery(this).on("change",(function(){var a="joe-dropdown-"+jQuery(this).data("id")+"-";jQuery("option",jQuery(this)).each((function(){e.removeClass(a+jQuery(this).attr("value"))})),a+=jQuery(this).val(),e.addClass(a)}))}))}))}function joe_setup_settings_nav(){var e=jQuery("body.wp-admin #joe-settings-nav");if(!e)return!1;var a=jQuery("#joe-admin-container"),t=jQuery("form",a),r=(jQuery(".joe-settings-tab",a),e.data("init_tab_key")),o=jQuery("select",e);o.hover((function(){jQuery(this).attr("size",jQuery("option",jQuery(this)).length)}),(function(){jQuery(this).removeAttr("size")})),o.change((function(){o.removeAttr("size");var e=jQuery(this).val();a.attr("class","");var n=jQuery('input[name="_wp_http_referer"]',t),i=document.location.toString();i=i.indexOf("content=")>0?i.replace("content="+r,"content="+e):i+"&content="+e,n.val(i);jQuery("."+e).first();jQuery(".joe-settings-tab").each((function(){var t=jQuery(this);t.hide(),e.indexOf("settings-tab")&&t.hasClass(e)&&(t.show(),a.addClass("joe-active-"+e)),jQuery(".waymark-settings-section",t).each((function(){var r=jQuery(this);e.indexOf("settings-tab")>0?r.show():e.indexOf("settings-section")>0&&(r.hide(),r.hasClass(e)&&(t.show(),r.show(),a.addClass("joe-active-"+e)))}))}))})),o.trigger("change")}function joe_setup_repeatable_parameters(){jQuery(".joe-repeatable-container").each((function(){var e=jQuery(this),a=e.data("count"),t=jQuery(".joe-repeatable-template",e);t.removeClass("joe-repeatable-template"),t.remove(),jQuery(".joe-parameters-container",e).each((function(){var e=jQuery(this),a=jQuery("<button />").html('<i class="ion ion-android-delete"></i>').addClass("button joe-delete").on("click",(function(a){a.preventDefault(),e.remove()}));e.append(a)}));var r=jQuery(".joe-repeatable-add",e).first();r.on("click",(function(o){o.preventDefault();var n=t.clone();return jQuery(".joe-input",n).each((function(){var e=jQuery(this);e.attr("name",e.attr("name").replace("__count__",a))})),jQuery(".waymark-control-label",n).each((function(){var e=jQuery(this);e.attr("for",e.attr("for").replace("__count__",a))})),r.before(n),n=waymark_handle_repeatable_clone(n),joe_setup_dropdowns(),e.data("count",++a),!1}))}))}function waymark_admin_message(e=null,a="info",t="#wpbody-content"){if(e){var r="";void 0!==waymark_admin_js.lang[a+"_message_prefix"]&&(r=waymark_admin_js.lang[a+"_message_prefix"]),r&&(r="<b>["+r+"]</b> ");var o=r+e,n=jQuery(t).first();if(n.length){jQuery(".waymark-notice",n).each((function(){jQuery(this).remove()}));var i=jQuery("<div />").attr({class:"waymark-notice notice notice-"+a}),s=jQuery("<p />").html(o);i.append(s),n.prepend(i)}else alert(o)}}jQuery(document).ready((function(){joe_setup_parameter_tooltips(),waymark_setup_accordions()})),jQuery(document).ready((function(){joe_setup_settings_nav(),joe_setup_repeatable_settings(),joe_setup_repeatable_parameters(),joe_setup_dropdowns()}));